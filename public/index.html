<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Solana Positions Dashboard</title>
    <meta name="theme-color" content="#0b1220" />
    <link rel="manifest" href="/manifest.webmanifest" />
    <link rel="icon" type="image/svg+xml" href="/icon.svg" />
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <main class="container">
      <header class="card compact-header">
        <div class="title-row">
          <h1>Strategy Dashboard</h1>
          <span id="status" class="status-pill">Idle</span>
        </div>
        <div class="controls-row">
          <input id="walletInput" type="text" placeholder="Enter Solana wallet address" />
          <button id="loadBtn" type="button">Load</button>
        </div>
        <div class="toolbar-row">
          <label class="inline-toggle"><input type="checkbox" id="autoRefresh" /> Auto-refresh (30s)</label>
          <span id="updatedAt" class="muted">Updated —</span>
        </div>
      </header>

      <section class="card">
        <h2>Portfolio Snapshot</h2>
        <div id="summaryCards" class="summary-strip"></div>
      </section>

      <section class="card">
        <div class="section-head">
          <h2>Delta Engine</h2>
          <span class="muted">Kamino Liquidity + Jupiter Perps hedge</span>
        </div>
        <div id="deltaMeta" class="summary-strip"></div>

        <div id="driftStrategyList" class="drift-list"></div>

        <div class="gauge-wrap">
          <div class="gauge-label">Drift Gauge <span id="driftPctLabel">—</span></div>
          <div class="drift-gauge" aria-label="Drift gauge zones">
            <div class="zone zone-green"></div>
            <div class="zone zone-yellow"></div>
            <div class="zone zone-red"></div>
            <div id="driftNeedle" class="drift-needle"></div>
          </div>
          <div class="gauge-ticks">
            <span>0%</span>
            <span>4%</span>
            <span>8%</span>
            <span>12%</span>
          </div>
          <div class="gauge-legend">OK &lt; 4% · Watch 4–8% · Rebalance &gt; 8%</div>
        </div>

        <h3>Liquidity</h3>
        <p class="sub-note">Net = Fees + Incentives − Costs (when available)</p>
        <div class="table-wrap"><div id="liquidityTableWrap"></div></div>

        <div class="hedge-head">
          <h3>Hedge (Perps)</h3>
          <span id="hedgeCoverage" class="muted">Hedge Coverage: —</span>
        </div>
        <div class="table-wrap"><div id="hedgeTableWrap"></div></div>
      </section>

      <section class="card">
        <h2>Multiply Engine</h2>
        <div id="multiplyTableWrap" class="table-wrap"></div>
      </section>

      <section class="card">
        <h2>Rewards & Wallet</h2>
        <div id="rewardsSummary" class="summary-strip"></div>
        <p class="sub-note">Claiming moves rewards into wallet balance (this dashboard is read-only).</p>
      </section>

      <details class="card">
        <summary>Settings (Advanced)</summary>
        <div class="details-body">
          <label class="inline-toggle"><input type="checkbox" id="betaEnabled" /> Enable Beta Lab (experimental)</label>
          <p class="muted">Beta Lab network calls are disabled in this layout.</p>
          <div id="debugStats" class="debug-list"></div>
          <pre id="debugObligationHints" class="raw-json"></pre>
        </div>
      </details>

      <details class="card">
        <summary>Advanced Data (collapsed)</summary>
        <div class="details-body">
          <h3>Raw Token Accounts</h3>
          <div id="walletTokensWrap" class="table-wrap"></div>
          <h3>Raw JSON</h3>
          <pre id="rawJson" class="raw-json"></pre>
          <h3>Raw Full Positions JSON</h3>
          <pre id="rawFullJson" class="raw-json"></pre>
        </div>
      </details>
    </main>

    <script type="module" src="/app.js"></script>
  </body>
</html>
